################################################################################
# This file was generated by Ansible for {{ansible_fqdn}}
# Do NOT modify this file by hand!
################################################################################

{% if nginx_default_fact.http.enable %}
server {
{% if nginx_default_fact.https.enable %}
    listen        {{ nginx_default_fact.http.listen | default(80) }};
    listen   [::]:{{ nginx_default_fact.http.listen | default(80) }};
{% else %}
    listen        {{ nginx_default_fact.http.listen | default(80) }} default_server;
    listen   [::]:{{ nginx_default_fact.http.listen | default(80) }} default_server;
{% endif %}
    server_name _;
{% if nginx_default_fact.https.enable %}
    return 301 https://$host$request_uri;
{% elif nginx_default_fact.http.block  %}
    return 444;
{% else %}
    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
    include {{ nginx_snippets_dir }}/errors.conf;
    include {{ nginx_snippets_dir }}/security.conf;
    include {{ nginx_snippets_dir }}/general.conf;
    include {{ nginx_snippets_dir }}/compression.conf;
{% endif %}
}
{% endif %}

{% if nginx_default_fact.https.enable %}
server {
    listen        {{ nginx_default_fact.https.listen | default(443) }} ssl http2 default_server;
    listen   [::]:{{ nginx_default_fact.https.listen | default(443) }} ssl http2 default_server;
    server_name _;
    ssl_reject_handshake on;
{% if nginx_default_fact.https.block %}
    return 444;
{% else %}
    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
    include {{ nginx_snippets_dir }}/errors.conf;
    include {{ nginx_snippets_dir }}/security.conf;
    include {{ nginx_snippets_dir }}/general.conf;
    include {{ nginx_snippets_dir }}/compression.conf;
{% endif %}
}
{% endif %}
